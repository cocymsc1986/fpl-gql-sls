service: fpl-gql-sls
# app and org for use with dashboard.serverless.com
app: fpl-gql
org: cocymsc1986
provider:
  region: us-east-1 
  name: aws
  runtime: nodejs12.x
  stage: ${opt:stage, 'local'}
  iamRoleStatements:
    - Effect: Allow
      Action:
        - lambda:*
      Resource:
        - arn:aws:lambda:${self:provider.region}:*:*
  environment:
    REGION: "${self:provider.region}"
    STAGE: "${self:provider.stage}"
    APPSYNC_NAME: "${self:custom.defaultPrefix}-appsync"

plugins:
  - serverless-appsync-plugin
  - serverless-appsync-simulator
  - serverless-offline
custom:
  appSync: # appsync plugin configuration
    name: "${self:provider.environment.APPSYNC_NAME}"
    authenticationType: API_KEY # since we dont have user login for now,
    serviceRole: "AppSyncServiceRole"
    dataSources: ${file(resources/data-sources.yml)}
    mappingTemplates: ${file(resources/resolvers.yml)}
  appsync-offline: # appsync-offline configuration
    port: 62222
  defaultPrefix: ${self:service}-${self:provider.stage}

functions:
  - ${file(resources/lambda-functions.yml)}

resources:
  # Roles
  - ${file(resources/roles.yml)}

